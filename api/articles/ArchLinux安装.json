{"title":"ArchLinux安装","slug":"ArchLinux安装","date":"2020-01-08T15:02:29.000Z","updated":"2020-03-05T11:41:22.515Z","comments":true,"path":"api/articles/ArchLinux安装.json","excerpt":null,"covers":null,"content":"<h3 id=\"系统安装\"><a href=\"#系统安装\" class=\"headerlink\" title=\"系统安装\"></a>系统安装</h3><blockquote>\n<p>这里的教程适用于UEFI+BIOS启动</p>\n</blockquote>\n<blockquote>\n<p>装的过程需要联网</p>\n</blockquote>\n<h3 id=\"1-连接网络\"><a href=\"#1-连接网络\" class=\"headerlink\" title=\"1. 连接网络\"></a>1. 连接网络</h3><p>   <b>1.1 扫描当前互联网设备</b></p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\">$ ip <span class=\"token function\">link</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>  <b>1.2 启用设备</b></p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\">$ ip <span class=\"token function\">link</span> <span class=\"token keyword\">set</span> 设备名 up<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>  <b>1.3 扫描WiFi</b></p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\">$ iwlist 设备名 scan <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> ESSID<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>   <b>1.4 连接网络</b></p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\">$ wpa_passphrase SSID <span class=\"token function\">passwd</span> <span class=\"token operator\">></span> internet.conf<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>   <b>分配IP</b></p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\">$ systemctl  start dhcdcp<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>   <b>1.6 测试连上网络</b></p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">ping</span> www.baidu.com<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>​    <strong>能ping通即可</strong></p>\n<h3 id=\"2-设置时区\"><a href=\"#2-设置时区\" class=\"headerlink\" title=\"2. 设置时区\"></a>2. 设置时区</h3><pre class=\"line-numbers language-bash\"><code class=\"language-bash\"> timedatectl set-ntp <span class=\"token boolean\">true</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h3>3.分区</h3>\n&gt; 我这里装到sda上,且sda 大小为64g,要查看你的分区表，可以`$ fdisk -l` \n\n<p>​    <b>3.1 编辑磁盘</b></p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\"> <span class=\"token function\">fdisk</span> /dev/sda   <span class=\"token comment\" spellcheck=\"true\">#给sda分区</span>\n g   <span class=\"token comment\" spellcheck=\"true\"># 清除原有分区并创建一个GPT分区表</span>\n n   <span class=\"token comment\" spellcheck=\"true\"># 创建一个新的分区/dev/sda1 -- 引导分区</span>\n     <span class=\"token comment\" spellcheck=\"true\"># 接下来选择分区编号、起始位置、终止位置（分区大小，可用“+300M”的形式）</span>\n n   <span class=\"token comment\" spellcheck=\"true\"># 创建一个swap分区/dev/sda3 -- SWAP分区（虚拟内存分区,分区不需要太大）</span>\n      <span class=\"token comment\" spellcheck=\"true\">#我设置为1G</span>\n n   <span class=\"token comment\" spellcheck=\"true\"># 创建一个新的分区/dev/sda2 -- 主分区</span>\n     <span class=\"token comment\" spellcheck=\"true\"># 大小我设置为磁盘的所有剩余空间</span>\n p   <span class=\"token comment\" spellcheck=\"true\"># 查看分区结果</span>\n w   <span class=\"token comment\" spellcheck=\"true\"># 写入</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>​    <b>3.2 格式化每个分区</b></p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\">$ mkfs.fat  -F32   /dev/sda1\n$ mkfs.ext4        /dev/sda2\n$ mkswap           /dev/sda3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>​    <b>3.3 打开swap</b></p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\">$ swapon           /dev/sda3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h3>4.换源</h3>\n* <b>编辑 /etc/pacman.d/mirrorlist</b>\n* <b>将第一个China下面的Server一行移到最顶上</b>\n\n<h3>5.安装ArchLinux</h3>\n  <b>5.1 挂载磁盘</b>\n\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">mkdir</span>        /mnt/boot                  <span class=\"token comment\" spellcheck=\"true\">#创建启动分区</span>\n$ <span class=\"token function\">mount</span>      /dev/sda1   /mnt/boot       <span class=\"token comment\" spellcheck=\"true\">#挂载启动分区</span>\n$ <span class=\"token function\">mount</span>      /dev/sda2    /mnt           <span class=\"token comment\" spellcheck=\"true\">#挂载主分区</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>  <b>5.2 开始 安装</b></p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\">$ pacstrap    /mnt base linux linux-firmware   <span class=\"token comment\" spellcheck=\"true\"># 安装Linux基础的软件</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>​     <b>5.3生成fstab文件</b></p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\">$ genfstab -U   /mnt   <span class=\"token operator\">>></span>   /mnt/etc/fstab<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h3>6.进入安装好的系统,设置一些本地化操作</h3>\n​    <b>6.1 进入系统</b> \n\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\">arch-chroot     /mnt<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>   <b>6.2 设置时区</b></p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">ln</span> -sf     /usr/share/zoneinfo/Asia/Shanghai     /etc/localtime <span class=\"token comment\" spellcheck=\"true\">#创建软连接</span>\n$ hwclock --systohc                                        <span class=\"token comment\" spellcheck=\"true\">#同步时间</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>   <b>6.3设置语言</b></p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\">$ <span class=\"token keyword\">echo</span> LANG<span class=\"token operator\">=</span>en_US.UTF-8    <span class=\"token operator\">></span>    /etc/locale.conf<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>​    <b>6.4 设置主机名</b></p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\">$ <span class=\"token keyword\">echo</span>   arch    <span class=\"token operator\">></span>    /etc/hostname<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>​    <b>6.5编辑hosts</b></p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\">$ vim            /etc/hosts       <span class=\"token comment\" spellcheck=\"true\">#其中加入以下几行 </span>\n  127.0.0.1     localhost\n  ::1          localhost\n  127.0.1.1      arch.localdomain   arch<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p>   <b>6.6设置root密码</b></p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">passwd</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h3>7.设置引导</h3>\n```bash\n$ pacman -S     grub    efibootmgr  intel-ucode  os-prober \n$ mkdir     /mnt/boot/grub\n$ grub-mkconfig    &gt;  /boot/grub/grub.cfg\n$ grub-install    --target=x86_64-efi    --efi-directory=/boot\n```\n\n<h3>8.安装一些基本工具</h3>\n```bash\n$ pacman -S vim nano vi dialog wpa_supplicant networkmanager dhcpcd net-tools  zsh\n```\n\n<h3>9.设置自启dhcpcd 服务</h3>\n```bash\n$ systemctl enable dhcpcd\n```\n\n<h3>10.重启</h3>\n```bash\n$ exit                            # 退出arch-chroot\n$ killall wpa_supplicant dhcpcd   # 终止掉网络相关的进程\n$ reboot                          # 重启，关机后就可以拔掉USB\n```<script>\n        document.querySelectorAll('.github-emoji')\n          .forEach(el => {\n            if (!el.dataset.src) { return; }\n            const img = document.createElement('img');\n            img.style = 'display:none !important;';\n            img.src = el.dataset.src;\n            img.addEventListener('error', () => {\n              img.remove();\n              el.style.color = 'inherit';\n              el.style.backgroundImage = 'none';\n              el.style.background = 'none';\n            });\n            img.addEventListener('load', () => {\n              img.remove();\n            });\n            document.body.appendChild(img);\n          });\n      </script>","more":"<h3 id=\"系统安装\"><a href=\"#系统安装\" class=\"headerlink\" title=\"系统安装\"></a>系统安装</h3><blockquote>\n<p>这里的教程适用于UEFI+BIOS启动</p>\n</blockquote>\n<blockquote>\n<p>装的过程需要联网</p>\n</blockquote>\n<h3 id=\"1-连接网络\"><a href=\"#1-连接网络\" class=\"headerlink\" title=\"1. 连接网络\"></a>1. 连接网络</h3><p>   <b>1.1 扫描当前互联网设备</b></p>\n<pre><code class=\"bash\">$ ip link</code></pre>\n<p>  <b>1.2 启用设备</b></p>\n<pre><code class=\"bash\">$ ip link set 设备名 up</code></pre>\n<p>  <b>1.3 扫描WiFi</b></p>\n<pre><code class=\"bash\">$ iwlist 设备名 scan | grep ESSID</code></pre>\n<p>   <b>1.4 连接网络</b></p>\n<pre><code class=\"bash\">$ wpa_passphrase SSID passwd &gt; internet.conf</code></pre>\n<p>   <b>分配IP</b></p>\n<pre><code class=\"bash\">$ systemctl  start dhcdcp</code></pre>\n<p>   <b>1.6 测试连上网络</b></p>\n<pre><code class=\"bash\">$ ping www.baidu.com</code></pre>\n<p>​    <strong>能ping通即可</strong></p>\n<h3 id=\"2-设置时区\"><a href=\"#2-设置时区\" class=\"headerlink\" title=\"2. 设置时区\"></a>2. 设置时区</h3><pre><code class=\"bash\"> timedatectl set-ntp true</code></pre>\n<h3>3.分区</h3>\n> 我这里装到sda上,且sda 大小为64g,要查看你的分区表，可以`$ fdisk -l` \n\n<p>​    <b>3.1 编辑磁盘</b></p>\n<pre><code class=\"bash\"> fdisk /dev/sda   #给sda分区\n g   # 清除原有分区并创建一个GPT分区表\n n   # 创建一个新的分区/dev/sda1 -- 引导分区\n     # 接下来选择分区编号、起始位置、终止位置（分区大小，可用“+300M”的形式）\n n   # 创建一个swap分区/dev/sda3 -- SWAP分区（虚拟内存分区,分区不需要太大）\n      #我设置为1G\n n   # 创建一个新的分区/dev/sda2 -- 主分区\n     # 大小我设置为磁盘的所有剩余空间\n p   # 查看分区结果\n w   # 写入</code></pre>\n<p>​    <b>3.2 格式化每个分区</b></p>\n<pre><code class=\"bash\">$ mkfs.fat  -F32   /dev/sda1\n$ mkfs.ext4        /dev/sda2\n$ mkswap           /dev/sda3</code></pre>\n<p>​    <b>3.3 打开swap</b></p>\n<pre><code class=\"bash\">$ swapon           /dev/sda3</code></pre>\n<h3>4.换源</h3>\n* <b>编辑 /etc/pacman.d/mirrorlist</b>\n* <b>将第一个China下面的Server一行移到最顶上</b>\n\n<h3>5.安装ArchLinux</h3>\n  <b>5.1 挂载磁盘</b>\n\n<pre><code class=\"bash\">$ mkdir        /mnt/boot                  #创建启动分区\n$ mount      /dev/sda1   /mnt/boot       #挂载启动分区\n$ mount      /dev/sda2    /mnt           #挂载主分区</code></pre>\n<p>  <b>5.2 开始 安装</b></p>\n<pre><code class=\"bash\">$ pacstrap    /mnt base linux linux-firmware   # 安装Linux基础的软件</code></pre>\n<p>​     <b>5.3生成fstab文件</b></p>\n<pre><code class=\"bash\">$ genfstab -U   /mnt   &gt;&gt;   /mnt/etc/fstab</code></pre>\n<h3>6.进入安装好的系统,设置一些本地化操作</h3>\n​    <b>6.1 进入系统</b> \n\n<pre><code class=\"bash\">arch-chroot     /mnt</code></pre>\n<p>   <b>6.2 设置时区</b></p>\n<pre><code class=\"bash\">$ ln -sf     /usr/share/zoneinfo/Asia/Shanghai     /etc/localtime #创建软连接\n$ hwclock --systohc                                        #同步时间</code></pre>\n<p>   <b>6.3设置语言</b></p>\n<pre><code class=\"bash\">$ echo LANG=en_US.UTF-8    &gt;    /etc/locale.conf</code></pre>\n<p>​    <b>6.4 设置主机名</b></p>\n<pre><code class=\"bash\">$ echo   arch    &gt;    /etc/hostname</code></pre>\n<p>​    <b>6.5编辑hosts</b></p>\n<pre><code class=\"bash\">$ vim            /etc/hosts       #其中加入以下几行 \n  127.0.0.1     localhost\n  ::1          localhost\n  127.0.1.1      arch.localdomain   arch</code></pre>\n<p>   <b>6.6设置root密码</b></p>\n<pre><code class=\"bash\">$ passwd</code></pre>\n<h3>7.设置引导</h3>\n```bash\n$ pacman -S     grub    efibootmgr  intel-ucode  os-prober \n$ mkdir     /mnt/boot/grub\n$ grub-mkconfig    >  /boot/grub/grub.cfg\n$ grub-install    --target=x86_64-efi    --efi-directory=/boot\n```\n\n<h3>8.安装一些基本工具</h3>\n```bash\n$ pacman -S vim nano vi dialog wpa_supplicant networkmanager dhcpcd net-tools  zsh\n```\n\n<h3>9.设置自启dhcpcd 服务</h3>\n```bash\n$ systemctl enable dhcpcd\n```\n\n<h3>10.重启</h3>\n```bash\n$ exit                            # 退出arch-chroot\n$ killall wpa_supplicant dhcpcd   # 终止掉网络相关的进程\n$ reboot                          # 重启，关机后就可以拔掉USB\n```","categories":[{"name":"Arch","path":"api/categories/Arch.json"}],"tags":[{"name":"Arch","path":"api/tags/Arch.json"}]}